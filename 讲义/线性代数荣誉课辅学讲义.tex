\documentclass{ctexbook}

\usepackage{geometry}
\geometry{
    % a4paper,
    paperheight=260mm,
    paperwidth=185mm,
    top=23mm,
    bottom=23mm,
    left=20mm,
    right=20mm,
}
% \usepackage[UTF8, heading = false, scheme = plain]{ctex} % 格式
\usepackage{ctex}
\usepackage[Bjornstrup]{fncychap} % found on Internet
\usepackage[utf8]{inputenc}
\usepackage{bm}
\usepackage{graphicx} % 添加图片
\usepackage{amsmath}
\renewcommand{\vec}[1]{\boldsymbol{#1}} % 生成粗体向量，而非带箭头的向量
\usepackage{amssymb}
\usepackage{booktabs} % Excel 导出的大表格
\usepackage{rotating}
\usepackage{extarrows}
\usepackage{enumitem}
\usepackage{xcolor}
\usepackage{multicol}
\usepackage{float}
\usepackage{mdframed}

\usepackage{tikz}
\usepackage{pgfplots}
\usetikzlibrary{cd, arrows, arrows.meta, calc, intersections, decorations.pathreplacing, patterns, decorations.markings}
\pgfplotsset{compat=1.17}

\usepackage{indentfirst}
\setlength{\parindent}{2em}

\usepackage{ntheorem}
\theoremheaderfont{\bfseries\heiti}
\theorembodyfont{\fangsong}

\usepackage{makeidx} % 名词索引
\makeindex % TODO 拼音排序

\usepackage{xparse}
% \keyterm{关键词}[英文] - 生成索引
% \keyterm*{关键词}[英文] - 不生成索引
\NewDocumentCommand{\keyterm}{smo}{%
    {\sffamily\heiti\bfseries{#2}%
    \IfNoValueF{#3}{（{#3}）}}%
    \IfBooleanF{#1}{\index{#2}}%
}

\usepackage{zhnumber}

% chapter 标题修改为第 * 讲
\ctexset{
    chapter={format={\centering\Huge\bfseries},name={第,讲},number=\arabic{chapter}},
    section={format={\raggedright\Large\bfseries},name={,},number={\arabic{chapter}.\arabic{section}}},
    subsection={format={\raggedright\large\bfseries},name={,},number={\arabic{chapter}.\arabic{section}.\arabic{subsection}}},
    subsubsection={format={\raggedright\normalsize\bfseries},name={,},number={\arabic{chapter}.\arabic{section}.\arabic{subsection}.\arabic{subsubsection}}},
}

\usepackage{mismath} % 包含 rank, span 等命令

\usepackage{pdfpages}

% hyperref 与 cleveref 需要最后引入
\usepackage{hyperref}
\usepackage{cleveref}
\hypersetup{
    colorlinks,
    pdfborder={0 0 0},
    bookmarksnumbered,
    pdfauthor={吴一航},
    pdftitle={线性代数荣誉课辅学讲义},
}

\newenvironment{proof}{\fangsong}{\hspace*{\fill}$\square$\par}
\newenvironment{solution}{\fangsong}{\par}

\mdfsetup{
    nobreak=false,
}

\mdfdefinestyle{framestyle}{
    ntheorem=true,
    % roundcorner=10pt,
    innertopmargin=\topskip,
    theoremseparator={},
    theoremspace=\quad,
    frametitlerulewidth=.5pt,
    frametitlerule=true,
    linewidth=.5pt,
    leftline=false,
    rightline=false,
    topline=true,
    bottomline=true,
    frametitlealignment=\raggedright\noindent,
}

\mdtheorem[
    style=framestyle,
    linecolor=red!50!black,
    frametitlebackgroundcolor=red!5,
]{definition}{定义}[chapter]
\mdtheorem[
    style=framestyle,
    linecolor=blue!50!black,
    frametitlebackgroundcolor=blue!5,
]{example}{例}[chapter]
\mdtheorem[
    style=framestyle,
    linecolor=orange!50!black,
    frametitlebackgroundcolor=orange!5,
]{lemma}{引理}[chapter]
\mdtheorem[
    style=framestyle,
    linecolor=violet!50!black,
    frametitlebackgroundcolor=violet!5,
]{theorem}{定理}[chapter]
\mdtheorem[
    style=framestyle,
    linecolor=green!50!black,
    frametitlebackgroundcolor=green!5,
]{corollary}{推论}[chapter]
\surroundwithmdframed[
    style=framestyle,
    linecolor=teal!80!black,
    frametitlebackgroundcolor=teal!5,
    frametitle={\noindent\bfseries\heiti 证明},
    % frametitleaboveskip=\topskip,
    % frametitlebelowskip=\topskip,
]{proof}
\surroundwithmdframed[
    style=framestyle,
    linecolor=teal!80!black,
    frametitlebackgroundcolor=teal!5,
    frametitle={\noindent\bfseries\heiti 解},
    % frametitleaboveskip=\topskip,
    % frametitlebelowskip=\topskip,
]{solution}

\renewcommand{\figureautorefname}{图}
\renewcommand{\tableautorefname}{表}
\renewcommand{\equationautorefname}{式}
\renewcommand{\theoremautorefname}{定理}
\renewcommand{\sectionautorefname}{节}
\newcommand{\lemmaautorefname}{引理}
\newcommand{\corollaryautorefname}{推论}
\newcommand{\exampleautorefname}{例}
\newcommand{\definitionautorefname}{定义}
\crefrangeformat{equation}{式~#3#1#4--#5#2#6}
\crefrangeformat{example}{例~#3#1#4--#5#2#6}

\DeclareMathOperator{\diag}{diag}

\title{\heiti 浙江大学 2023--2024 学年 \\ 线性代数荣誉课辅学讲义}
\author{2023--2024 学年线性代数 I/II（H）辅学授课 \\ 吴一航 \quad \verb|yhwu_is@zju.edu.cn|}

% 嵌套 enumerate 环境的 label
\setlist[enumerate,2]{label=(\arabic*)}
\setlist[enumerate,3]{label=\roman*.}

\begin{document}
\frontmatter

% 封面，代替 \maketitle
\includepdf[pages={1}]{./figs/cover.pdf}

\songti

{% 插入空页
	\null
	\thispagestyle{empty}
	\clearpage
	\thispagestyle{empty}
	\input{./其它/扉页.tex}
}
\clearpage
\setcounter{page}{1}
\input{./其它/序.tex}
\input{./其它/致读者.tex}

\clearpage
\pdfbookmark[0]{目录}{contents}
\tableofcontents

\addtolength{\parskip}{.5em}

\mainmatter
\setcounter{page}{1} % 将页码计数设置为 1
\input{./专题/1 预备知识.tex}
\input{./专题/2 线性空间.tex}
\input{./专题/3 有限维线性空间.tex}
\input{./专题/4 线性空间的运算.tex}
\input{./专题/5 线性映射.tex}
\input{./专题/6 线性映射基本定理.tex}
\input{./专题/7 线性映射矩阵表示（I）.tex}
\input{./专题/8 线性映射矩阵表示（II）.tex}
\input{./专题/9 线性映射矩阵表示（III）.tex}
\input{./专题/10 矩阵运算进阶（I）.tex}
\input{./专题/11 矩阵的秩.tex}
\input{./专题/12 矩阵运算进阶（II）.tex}
\input{./专题/13 行列式（I）.tex}
\input{./专题/14 行列式计算进阶.tex}
\input{./专题/15 朝花夕拾.tex}
\input{./专题/16 史海拾遗.tex}
\input{./专题/17 多项式.tex}
\input{./专题/18 不变子空间.tex}
\input{./专题/19 相似标准形（I）.tex}
\input{./专题/20 相似标准形（II）.tex}
\input{./专题/21 多项式的进一步讨论.tex}
\input{./专题/22 若当标准形.tex}
\input{./专题/23 内积空间.tex}
\input{./专题/24 内积空间上的算子（I）.tex}
\input{./专题/25 内积空间上的算子（II）.tex}
\input{./专题/26 二次型.tex}
\input{./专题/27 极分解与奇异值分解.tex}
\input{./专题/28 实空间上的算子.tex}
\input{./专题/29 行列式（II）.tex}
\input{./专题/30 线性代数与解析几何基础.tex}
\input{./专题/31 线性代数与多元微积分.tex}
\input{./专题/32 线性代数与统计学.tex}

\backmatter
\pdfbookmark[0]{索引}{index}
\printindex

\end{document}
