\chapter{内积空间}

\section{内积和范数}

\subsection{内积和范数的定义及性质}

前面研究的所有空间都是线性空间，只注重于线性结构，忽视了向量的度量性质，如向量的长度、夹角等. 但度量性质恰是在分析、几何问题中不可缺少的. 故从此章起，我们引入度量的概念，将线性空间推广为内积空间.

\term{内积}\index{neiji@内积 (inner product)}的引入始于我们曾在高中研究过的 $\mathbf{R}^{2}$ 与 $\mathbf{R}^{3}$ 上的向量点积，范数则是始于向量的长度概念. 内积即是点积性质的推广，本质上就是一个函数，它把 $ V $ 中元素的每个有序对 $(u, v)$ 都映射成一个数$ \langle u, v \rangle \in \mathbf{F}$，并且具有以下性质：

\begin{enumerate}
    \item 正定性：$\forall v \in V, \enspace \langle v, v \rangle \geqslant 0, \enspace \langle v, v \rangle = 0 \iff v = \vec{0}$；

    \item 第一个位置的加性：$\forall u, v, w \in V, \enspace \langle u + v, w \rangle = \langle u, w \rangle + \langle v, w \rangle$；

    \item 第一个位置的齐性：$\forall \lambda \in \mathbf{F}, \enspace \forall u, v \in V, \enspace \langle \lambda u, v \rangle = \lambda \langle u, v \rangle$；

    \item 共轭对称性：$\forall u, v \in V, \enspace \langle u, v \rangle = \overline{\langle v, u \rangle}$.
\end{enumerate}

每个实数都等于它的复共轭，所以在处理实向量空间时，共轭对称性实际上转变为对称性，即：$\forall u, v \in V, \enspace \langle u, v \rangle = \langle v, u \rangle$.

而由以上定义，我们可以快速得到以下性质：

\begin{enumerate}
    \item 对于每个取定的 $u \in V$，将 $ v $ 变为 $\langle v, u \rangle$ 的函数是 $ V $ 到 $\mathbf{F}$ 的线性映射.

    \item $\forall u \in V, \enspace \langle \vec{0}, u \rangle = \langle u, \vec{0} \rangle = 0$.

    \item $\forall u, v, w \in V, \enspace \langle u, v + w \rangle = \langle u, v \rangle + \langle u, w \rangle$.

    \item $\forall \lambda \in \mathbf{F}, \enspace \forall u, v \in V, \enspace \langle u, \lambda v \rangle = \overline{\lambda} \langle u, v \rangle$.
\end{enumerate}

其实从以上的定义与性质可以发现，实内积空间上的内积与我们之后要提到的双线性函数有着密不可分的联系——实线性空间上的正定对称双线性函数实际上就是该空间上的一个内积，在此先按下不表.

内积定义完成后，便可由该内积确定一个相应的范数：对于 $v \in V$，$v$ 的\term{范数}\index{fanshu@范数 (norm)}（记作 $ \lVert v \rVert $）定义为 $ \lVert v \rVert = \sqrt{\langle v, v \rangle}$. 并且具有以下性质：

\begin{enumerate}
    \item $\forall v \in V, \enspace \left\lVert v \right\rVert = 0 \iff v = \vec{0}$.

    \item $\forall v \in V, \enspace \forall \lambda \in \mathbf{F}, \enspace \left\lVert \lambda v \right\rVert  = \left\lvert \lambda \right\rvert \lVert v \rVert$.
\end{enumerate}

上述性质留给读者自证，从中我们也能发现一个普遍原理：处理范数的平方通常比直接处理范数更容易.

以下给出几个内积和范数的示例：

\begin{example}{}{内积和范数}
    \begin{enumerate}
        \item $\mathbf{F}^{n}$ 上的欧几里得内积定义为：
              \[\left\langle (w_1, \ldots, w_n), (z_1, \ldots, z_n)\right\rangle = w_1\overline{z_1} + \cdots + w_n\overline{z_n} = \vec{w}\overline{\vec{z}}^{\mathrm{T}}\]
              对应范数：
              \[\left\lVert (z_1, \ldots, z_n) \right\rVert  = \sqrt{\lvert z^2_1 \rvert + \cdots + \lvert z^2_n \rvert}\]

        \item \label{item:23:内积和范数:2}
              定义在 $ \left[-1, 1\right] $ 上的连续实值函数构成的向量空间可定义内积如下：
              \[\left\langle f, g\right\rangle = \int_{-1}^1f(x)g(x)\,\mathrm{d}x\]
              对应范数：
              \[\left\lVert f \right\rVert = \sqrt{\int_{-1}^1(f(x))^2\,\mathrm{d}x}\]
    \end{enumerate}
\end{example}

\subsection{正交的定义 \quad 基于正交的性质}

以下给出一个关键定义：

\begin{definition}{}{}\index{zhengjiao@正交 (orthogonal)}
    两个向量 $u, v \in V$ 称为\term{正交的}，如果 $\langle u, v\rangle = 0$.
\end{definition}

该定义中向量的次序是无关紧要的，因为 $\langle u, v\rangle = 0 \iff \langle v, u\rangle = 0$.

那么正交的定义关键在何处呢？以下给出 $\mathbf{R}^{n}$ 空间上夹角的定义以供理解（证明良定义需要用到 Cauchy-Schwarz 不等式）：

\begin{definition}{}{}
    设 $u, v \in \mathbf{R}^{n}$，则 $u, v$ 的夹角 $ \theta $ 为$ \theta = \arccos \dfrac{\langle u, v\rangle}{\lVert u \rVert \lVert v \rVert}$.
\end{definition}

那么我们可以发现，当两向量正交时，它们的夹角就是 $\dfrac{\pi}{2}$，也就是我们在几何中常说的垂直，它能将我们导向一些重要的定理.

让我们从一些简单的结果开始研究正交性，比如正交性与 $ \vec{0} $ 的关系：

\begin{enumerate}
    \item $ \vec{0} $ 正交与 $V$ 中的任意向量.

    \item $ \vec{0} $ 是 $V$ 中唯一一个与自身正交的向量.
\end{enumerate}

然后是熟悉的勾股定理在内积空间上的推广：

\begin{theorem}{}{}
    设 $u, v$ 是 $V$ 中的正交向量，则 $\lVert u + v \rVert^2 = \lVert u \rVert^2 + \lVert v \rVert^2 $.
\end{theorem}

\begin{proof}
    因为 $u, v$ 互相正交，所以 $\langle u, v \rangle = \langle v, u \rangle = 0$.
    \begin{align*}
        \lVert u + v \rVert^2 & = \langle u + v, u + v \rangle \\
                              & = \langle u, u \rangle + \langle u, v \rangle + \langle v, u \rangle + \langle v, v \rangle \\
                              & = \lVert u \rVert^2 + \lVert v \rVert^2
    \end{align*}
\end{proof}

注意勾股定理的逆定理仅在实内积空间上成立.

借助于正交的性质，我们能够简化很多与内积相关的计算，进而会很自然的思考这样一个问题：一个向量能否分解两个互相正交的向量？

从而便引进了正交分解：

\begin{theorem}{}{}
    设 $u, v \in V$ 且 $v \neq \vec{0}$. 令 $ c = \dfrac{\langle u, v\rangle}{\lVert v \rVert^2}, \enspace w = u - \dfrac{\langle u, v\rangle}{\lVert v \rVert^2}v$. 则 $\langle w, v\rangle = 0$且 $u = cv + w$.
\end{theorem}

而通过正交分解，我们可以证明一个数学中最重要的不等式（之一）：\term{Cauchy-Schwarz 不等式}.

\begin{theorem}{Cauchy-Schwarz 不等式}{} \index{Cauchy@Cauchy-Schwarz 不等式 (Cauchy-Schwarz inequality)}
    设 $u, v \in V$. 则 $\left\lvert \left\langle u, v\right\rangle \right\rvert \leqslant \lVert u \rVert\lVert v \rVert$. 等号成立当且仅当 $u, v$ 之一是另一个的标量倍.
\end{theorem}

也可以通过引入参数，利用二次三项式的判别式证明.

借助 Cauchy-Schwarz 不等式，我们可以得到三角不等式：

\begin{theorem}{}{}
    设 $u, v \in V$. 则 $\lVert u, v \rVert \leqslant \lVert u \rVert + \lVert v \rVert$. 等号成立当且仅当 $u, v$ 之一是另一个的非负标量倍.
\end{theorem}

其几何解释就是俗称的三角形两边之和小于第三边.

另一个与几何相关的结论就是平行四边形恒等式：

\begin{theorem}{}{}
    设 $u, v \in V$. 则 $ \lVert u + v \rVert^{2} + \lVert u - v \rVert^{2} = 2(\lVert u \rVert^{2} + \lVert v \rVert^{2})$.
\end{theorem}

其几何解释为任意的平行四边形两对角线的长度的平方和等于四边长度的平方和.

以下为另外几个与内积有关的恒等式，我们会在证明正规算子和自伴算子的性质时运用到它们：

\begin{example}{}{}
    证明下列式子成立：
    \begin{enumerate}
        \item $\mathbf{F} = \mathbf{R}$ 时：
              \begin{gather}
                  \label{eq:23:内积和范数的性质1}
                  \langle u, v\rangle = \frac{1}{4}\left( \lVert u + v \rVert^2 - \lVert u - v \rVert^2\right) \\
                  \label{eq:23:内积和范数的性质2}
                  \langle Tu, v\rangle + \langle Tv, u\rangle = \frac{1}{2}\left(\langle T(u + v), u + v\rangle - \langle T(u - v), u - v\rangle\right)
              \end{gather}

        \item $\mathbf{F} = \mathbf{C}$ 时：
              \begin{gather}
                  \label{eq:23:内积和范数的性质3}
                  \langle u, v\rangle = \frac{1}{4}\left((\lVert u + v \rVert^2 - \lVert u - v \rVert^2) + \i(\lVert u + \i v \rVert^2 - \lVert u - \i v \rVert^2)\right) \\
                  \label{eq:23:内积和范数的性质4}
                  \begin{aligned}
                      \langle Tu, v\rangle ={} & \frac{1}{4}  ((\langle T(u + v), u + v\rangle - \langle T(u - v), u - v\rangle)     \\
                                               & + \i(\langle T(u + \i v), u + \i v\rangle + \langle T(u - \i v), u - \i v\rangle)).
                  \end{aligned}
              \end{gather}
    \end{enumerate}

\end{example}

\section{标准正交基}

这一节我们将沿着正交的路径接着往下走，看看如果整个向量组乃至一组基都是单位化的且互相正交的话，会有怎样的性质. 我们也会讲解如何获取这样一组基的算法，并介绍 Riesz 表示定理，其揭示了线性泛函和内积的深刻联系.

\begin{definition}{}{}\index{zhengjiao!biaozhun@标准正交 (orthonormal), 规范正交}
    如果一个向量组的每个向量范数都是 1 且与其他向量正交则称这个向量组是\term{标准正交}（规范正交）的.
\end{definition}

在本书的剩余部分中我们都称此性质为标准正交.

由以上定义，我们得出：$ V $ 上的向量组 $ e_1, \ldots , e_n $ 是标准正交的，如果
\[ \langle e_j, e_k \rangle = \delta _{jk} = \begin{cases}
        1 & j = k    \\
        0 & j \neq k
    \end{cases} \]

标准正交组的优势在于处理其线性组合的范数很方便.

\begin{theorem}{}{}
    若 $e_1, \ldots , e_m$ 是 $ V $ 中的标准正交向量组，则对 $\forall a_1, \ldots, a_m \in \mathbf{F}$ 均有
    \[ \lVert a_1e_1 + \cdots + a_ne_n\rVert^2 = \lvert a_1 \rvert^2 + \cdots + \lvert a_n \rvert^2.\]
\end{theorem}

反复使用勾股定理即可证明. 该定理也有一个重要推论：

\begin{theorem}{}{}
    任何标准正交向量组都是线性无关的.
\end{theorem}

令其线性组合为 $ \vec{0} $ 即证.

\begin{example}{}{标准正交组}
    设 $e_1, \ldots , e_m$ 是 $ V $ 的标准正交组. 设 $ v \in V $. 证明
    \[ \lVert v \rVert^2 = \lvert \langle v, e_1\rangle \rvert^2 + \cdots + \lvert \langle v, e_m\rangle \rvert^2 \]
    当且仅当 $ v \in \spa(e_1, \ldots , e_m)$.
\end{example}

既然标准正交组都是线性无关的，很自然我们就会想到在线性空间中最有用的线性无关组：基. 也就有了标准正交基的定义.

\begin{definition}{}{}
    $ V $ 的标准正交基是 $ V $ 中的标准正交向量组构成的基.
\end{definition}

而由向量组确定为基的等价条件，易知长度为 $\dim V$ 的标准正交向量组都是$ V $ 的标准正交基.

标准正交基的优势就在于表出向量的表出系数可以确定.

\begin{theorem}{}{}
    设 $e_1, \ldots e_n$ 是 $ V $ 标准正交基且 $ v \in V$. 则
    \begin{equation} \label{eq:23:Fourier展开}
        v = \langle v, e_1 \rangle e_1 + \cdots + \langle v, e_n \rangle e_n
    \end{equation}
    且
    \[ \lVert v \rVert^2 = \lvert \langle v, e_1\rangle \rvert^2 + \cdots + \lvert \langle v, e_m\rangle \rvert^2. \]
\end{theorem}

此为\autoref{ex:标准正交组} 的特例. \autoref{eq:23:Fourier展开} 也被称为 $ v $ 的 Fourier 展开，其中每个系数 $ \langle v, e_j \rangle $ 被称为 $ v $ 的 Fourier 系数.

标准正交基的性质十分美妙，但我们取出一组基使得其恰好是标准正交基是十分困难的，所幸前人已经研究出了一套算法，可以将所有线性无关组转变为标准正交组，且张成空间相同.

\begin{theorem}{Gram-Schmidt 过程}{} \index{Gram@Gram-Schmidt 过程 (Gram-Schmidt process)}
    设 $v_1, \ldots ,v_n$ 是 $ V $ 中的线性无关向量组. 设 $e_1 = \dfrac{v_1}{\lVert v_1 \rVert}$. 对于 $ j = 2, \ldots , m$，定义 $ e_j $ 如下：
    \[ e_j = \frac{v_j - \langle v_j, e_1 \rangle e_1 - \cdots - \langle v_j, e_{j - 1} \rangle e_{j - 1} }{\lVert v_j - \langle v_j, e_1 \rangle e_1 - \cdots - \langle v_j, e_{j - 1} \rangle e_{j - 1} \rVert}\]
    则 $e_1, \ldots , e_m $ 是 $ V $ 中的标准正交组，使得对 $ j = 1, \ldots , m $ 有
    \[ \spa(v_1, \ldots, v_j) = \spa(e_1, \ldots, e_j) \]
\end{theorem}

证明前半部分使用归纳法，后半部分证明两向量组等价即可.

让我们简单运用一下 Gram-Schmidt 过程.
\begin{example}{}{}
    求 $\mathbf{R}[x]_2$ 的一组标准正交基，内积定义为 $\langle p, q \rangle = \displaystyle\int_{-1}^1 p(x)q(x)\,\mathrm{d}x$.
\end{example}

不难发现，Gram-Schmidt 过程实际上可以分成两部分：
\begin{enumerate}
    \item 正交化：定义 $ u_1 = v_1 , \enspace u_j = v_j - \langle v_j, e_1 \rangle e_1 - \cdots - \langle v_j, e_{j - 1} \rangle e_{j - 1}, \enspace j = 2, \ldots , m$，此时 $u_1, \ldots , u_m$ 已经互相正交.

    \item 单位化：$ e_j = \dfrac{u_j}{\lVert u_j \rVert} , \enspace j = 1, \ldots , m$，从而有 $\lVert e_j \rVert = 1, \enspace j = 1, \ldots , m$
\end{enumerate}

Gram-Schmidt 过程可以说是线性代数计算较为困难的方面之一，也是应试经常考察的方面，需要多加注意.

借助 Gram-Schmidt 过程，显然我们可以得到以下结论：
\begin{enumerate}
    \item 每个有限维内积空间都有标准正交基；

    \item 设 $ V $ 是有限的. 则 $ V $ 中每个标准正交向量组都可以扩充成 $ V $ 的标准正交基.
\end{enumerate}
也可以得到这样一个定理.

\begin{theorem}{Schur 定理}{Schur} \index{Schur@Schur 定理 (Schur's triangularization theorem)}
    设 $ V $ 是有限维的复内积空间，且 $ T \in \mathcal{L}(V) $，则 $ T $ 关于 $ V $ 的某个标准正交基具有上三角矩阵.
\end{theorem}

证明并不复杂，只需要结合\autoref{thm:上三角矩阵存在} 和 Gram-Schmidt 过程即可. 虽然十分浅显，但它迈出了我们在内积空间上算子简化表示的第一步，在更进一步的结论中我们会运用到它.

\section{内积的表示方式}

在此我们先打住，回忆一下内积的定义，其本质上就是一个函数，它把 $ V $ 中元素的每个有序对 $(u, v)$ 都映射成一个数$ \langle u, v \rangle \in \mathbf{F}$，而我们也很熟悉一类把 $ V $ 中元素映射成一个数的函数，即所谓的线性泛函. 那么这两者之间是否存在着某种联系？我们先借助几个例子观察一下.

\begin{example}{}{}
    \begin{enumerate}
        \item 定义如下的函数 $\varphi\colon \mathbf{F}^{3} \rightarrow \mathbf{F}$
              \[\varphi(z_1, z_2, z_3) = 2z_1 - 5z_2 + z_3\]
              是 $\mathbf{F}^{3}$ 上的线性泛函. 我们可以将其写成以下形式：$ \forall z \in \mathbf{F}^{3}$，
              \[\varphi(z) = \langle z, u\rangle\]
              其中 $u = (2, -5, 1)$.

        \item 定义如下的函数 $\varphi\colon \mathbf{R}[x]_2 \rightarrow \mathbf{R}$
              \[\varphi(p) = \int_{-1}^1 p(t)(\cos(\pi t))\,\mathrm{d}t\]
              是 $\mathbf{R}[x]_2$ 上的线性泛函, 此处的内积为\autoref{ex:内积和范数} \ref*{item:23:内积和范数:2} 中定义的. 但以下的事实并不那么显然：$ \exists u \in \mathbf{R}[x]_2$, 使得$\forall p \in \mathbf{R}[x]_2$ 均有 $ \varphi (p) = \langle p, u\rangle $.
    \end{enumerate}
\end{example}

可以发现，若是固定内积的第二个位置上的向量，内积就等同于一个线性泛函. 即对于确定的 $ u \in V , \enspace \varphi(v) = \langle v, u \rangle$ 就是一个线性泛函. 下面的定理揭示了这两者的关系，其指出 $ V $ 上所有的线性泛函都是这种形式：
\begin{theorem}{Riesz 表示定理}{Riesz} \index{Riesz@Riesz 表示定理 (Riesz representation theorem)}
    设 $ V $ 是有限维的且 $ \varphi $ 是 $ V $ 上的线性泛函，则存在唯一的向量$u \in V$ 使得对 $\forall v \in V$ 均有 $ \varphi(v) = \langle v, u\rangle $.
\end{theorem}

\begin{proof}
    存在性：设 $e_1, \ldots , e_n$ 是 $ V $ 上的一组标准正交基，则对 $\forall v \in V $ 均有
    \begin{align*}
        \varphi (v) & = \varphi(\langle v, e_1 \rangle e_1 + \cdots + \langle v, e_n \rangle e_n )           \\
                    & = \langle v, e_1 \rangle \varphi (e_1) + \cdots + \langle v, e_n \rangle \varphi (e_n) \\
                    & = \langle v, \overline{\varphi(e_1)}e_1 + \cdots + \overline{\varphi(e_n)}e_n \rangle
    \end{align*}
    故取
    \[ u = \overline{\varphi(e_1)}e_1 + \cdots + \overline{\varphi(e_n)}e_n, \]
    对 $\forall v \in V$ 都有 $\varphi(v) = \langle v, u \rangle $.

    唯一性：设 $ u_1, u_2 \in V $ 使得对 $\forall v \in V $ 均有
    \[\varphi(v) = \langle v, u_1 \rangle = \langle v, u_2 \rangle.\]
    则对 $\forall v \in V $ 均有
    \[ 0 = \langle v, u_1 \rangle - \langle v, u_2 \rangle = \langle v, u_1 - u_2 \rangle\]
    取 $ v = u_1 - u_2 $ 可得 $ u_1 - u_2 = 0 $，即 $ u_1 = u_2 $，唯一性得证.
\end{proof}

\nameref{thm:Riesz}不仅证明了内积和线性泛函的联系，也给出了求解向量 $ u $ 的公式使其满足$ \forall v \in V $，使得 $ \varphi(v) = \langle v, u\rangle $. 具体来说，就是
\[ u = \overline{\varphi(e_1)}e_1 + \cdots + \overline{\varphi(e_n)}e_n, \]
而根据 \nameref{thm:Riesz}，我们知道 $ u $ 只依赖于线性泛函 $ \varphi $，所以选取任意一组$ V $ 上的标准正交基都会计算出相同的结果.

按以往的经验，该节的内容常在考试中作为大题单独考察.
\begin{example}{}{}
    定义在 $ V = \mathbf{R}^3 $ 上的运算
    \[ \langle \vec{x}, \vec{y} \rangle_V = x_1 y_1 + x_2 y_2 + (x_2 + x_3)(y_2 + y_3) \]
    其中 $ \vec{x} = (x_1, x_2, x_3),\enspace \vec{y} = (y_1, y_2, y_3) $.
    \begin{enumerate}
        \item 验证 $ \langle \cdot, \cdot \rangle_V $ 是 $ \mathbf{R}^3 $ 上的一个内积；

        \item 求 $ \mathbf{R}^3 $ 在 $ \langle \cdot, \cdot \rangle_V $ 下的一组标准正交基；

        \item 求 $ \vec{\beta} \in V $ 使得 $ \forall \vec{x} \in V,\enspace x_1 + 2x_2 = \langle \vec{x}, \vec{\beta} \rangle_V $.
    \end{enumerate}
\end{example}

但内积的表示方式也不仅仅只与线性泛函相关，考虑取定一组基 $ (e_1, \ldots , e_n) $，考虑 $ v, w \in V $，其在此组基下的坐标分别为 $ \alpha = (a_1, \ldots , a_n) $ 和 $ \beta = (b_1, \ldots , b_n) $，若 $ \langle e_i, e_j \rangle = g_{ij} $，则有

\begin{align*}
    \langle v, w \rangle & = \langle a_1e_1 + \cdots + a_ne_n, b_1e_1 + \cdots + b_ne_n \rangle \\
                         & = a_1g_{11}\bar{b}_1 + \cdots + a_ng_{nn}\bar{b}_n                   \\
                         & = (a_1, \ldots, a_n) \begin{pmatrix}
                                                    g_{11} & \cdots & g_{1n} \\
                                                    \vdots & \ddots & \vdots \\
                                                    g_{n1} & \cdots & g_{nn}
                                                \end{pmatrix} \begin{pmatrix}
                                                                  \bar{b}_1 \\
                                                                  \vdots    \\
                                                                  \bar{b}_n
                                                              \end{pmatrix}
    = \alpha G \bar{\beta}^{\mathrm{T}}
\end{align*}

此处的矩阵 $ G $ 被称为内积在基 $ (e_1, \ldots, e_n) $ 下的 \term{Gram 矩阵}，显然在实空间下它是对称矩阵，而在复空间下它是共轭对称矩阵. 矩阵的共轭对称依托于共轭转置操作，我们会在下一节中介绍. 此外，因为内积的正定性，所以 $ \alpha G \bar{\alpha}^{\mathrm{T}} > 0$，这也是 Gram 矩阵的一个重要性质，也被称作正定性. 可以发现 Gram 矩阵的特性实际上是与内积的性质相对应的.

而内积在任一一组标准正交基下的 Gram 矩阵都是单位矩阵，这也是标准正交基的一个重要性质.

\section{正交补}

本节的内容更偏向于几何方向，将带领大家了解空间的正交补，以及一种特殊的映射：正交投影. 并介绍一下极小化问题及一点应用.

\subsection{正交补 \quad 正交投影}

\begin{definition}{正交补}{} \index{zhengjiao!bu@补 (orthogonal complement)}
    设 $ U $ 是 $ V $ 的子集，则 $ U $ 的\term{正交补}（记作 $ U^{\perp } $）是由 $ V $ 中与 $ U $ 的每个向量都正交的那些向量组成的集合：
    \[U^{\perp } = \{ v \in V \mid \forall u \in U, \enspace \langle v, u\rangle = 0\}\]
\end{definition}

例如，若 $ U $ 是 $ \mathbf{R}^{3} $ 中的直线，则 $ U^{\perp } $ 是垂直于 $ U $ 且包含原点的平面. 若 $ U $ 是 $ \mathbf{R}^{3} $ 中的平面，则 $ U^{\perp } $ 是垂直于 $ U $ 且包含原点的直线.

正交补具有如下的基本性质：
\begin{enumerate}
    \item 若 $ U $ 是 $ V $ 的子集（注意使用的是子集），则 $ U^{\perp }$ 是 $ V $ 的子空间.

    \item $ \{ \vec{0} \}^{\perp } = V $.

    \item $ V^{\perp } = \{ \vec{0} \} $.

    \item 若 $ U $ 是 $ V $ 的子集，则 $ U \cap U^{\perp } \subset \{ \vec{0} \}$.

    \item 若 $ U $ 和 $ W $ 均为 $ V $ 的子集且 $ U \subset W $，则 $ W^{\perp } \subset U^{\perp }$.
\end{enumerate}

那么根据之前的几何示例，我们不难猜测，如果 $ U $ 上升成为了一个子空间，那么就可以诱导一个自然的直和分解.

\begin{theorem}{}{}
    设 $ U $ 是 $ V $ 的有限维子空间，则 $ V = U \oplus U^{\perp } $.
\end{theorem}

由该直和分解，我们可以推出两个结论：
\begin{enumerate}
    \item 若 $ V $ 是有限维的且 $ U $ 是 $ V $ 的子空间，则$ \dim U^{\perp }= \dim V - \dim U$

    \item 设 $ U $ 是 $ V $ 的有限维子空间，则 $ U = (U^{\perp})^{\perp} $
\end{enumerate}
第二条的证明还是具有一定技巧性的，希望读者仔细品味.

除去这两个结论，该直和分解为我们定义正交投影奠定了基础：
\begin{definition}{}{}\index{zhengjiao@touying@投影 (orthogonal projection)}
    设 $ U $ 是 $ V $ 的有限维子空间. 定义 $ V $ 到 $ U $ 上的\term{正交投影}为如下算子$ P_U \in \mathcal{L} (V)$：对 $ v \in V $ 将其写成 $ v = u + w $，其中$ u \in U $ 且 $ w \in U^{\perp }$，则 $ P_U v = u $.
\end{definition}

正交投影的性质相当之多，不过大部分是成对刻画以及简单的推理，在此仅作罗列不加证明：

设 $ U $ 是 $ V $ 的有限维子空间且 $ v \in V$. 则
\begin{enumerate}
    \item $ P_U \in \mathcal{L} (V) $；

    \item 对 $ \forall u \in U$ 均有 $ P_U u = u $；

    \item 对 $ \forall w \in U^{\perp}$ 均有 $ P_U w = \vec{0} $；

    \item $ \im P_U = U$；

    \item $ \ker P_U = U^{\perp}$；

    \item $ v - P_U v \in U^{\perp}$；

    \item \label{item:23:正交投影性质:7}
          $ {P_U}^{2} = P_U$；

    \item $ \lVert P_U v\rVert \leqslant \lVert v \rVert $；

    \item 对 $ U $ 的每个规范正交基 $e_1, \ldots , e_m$ 均有 $ P_U v = \langle v, e_1 \rangle e_1 + \cdots + \langle v, e_m \rangle e_m$.
\end{enumerate}
其中由 \ref*{item:23:正交投影性质:7} 我们知道正交投影存在一种矩阵表示是幂等的，且进一步可以证明在实空间上则是对称幂等的，这一性质在卡方分布中有着运用，此处仅仅介绍一下.

\begin{example}{}{}
    设 $ U $ 是实内积空间 $ V $ 的一个有限维子空间. 证明：正交投影 $ P_U $ 具有以下性质：
    \[\langle P_U u, v\rangle = \langle u, P_U v\rangle, \enspace \forall u, v \in V \]
\end{example}

这个例子的意义可能你暂时还没法理解，但等你学习完正规算子与自伴算子后，再结合这个例子，你会发现实内积空间上的正交投影存在一种对称幂等的矩阵表示形式是显然的.

\subsection{极小化问题}

我们常会遇到这样的一种问题：给定 $ V $ 的子空间 $ U $ 和点 $ v \in V $，求点$ u \in U $ 使得 $ \lVert v - u \rVert $ 最小. 下面的定理表明，取 $ u = P_U v$即可解决此极小化问题.

\begin{theorem}{}{}
    设 $ U $ 是 $ V $ 的有限维子空间，$ v \in V $ 且 $ u \in U $. 则
    \[\lVert v - P_U v \rVert \leqslant \lVert v - u \rVert. \]
    等号成立当且仅当 $ u = P_U v $.
\end{theorem}

\subsubsection*{$^*$ 极小化问题的应用：最小二乘解}

在许多实际问题中我们需要研究一个变量 $ y $ 和其他一些变量 $ x_1, \ldots , x_n $之间的依赖关系. 经过实际观测和分析，假定 $ y $ 与 $ x_1, \ldots , x_n $ 之间呈线性关系，即
\[ y = k_1 x_1 + \cdots + k_n x_n, \]
其中系数 $ k_1, \ldots , k_n $ 是未知的，为确定它们，需要观测数据 $ m $ 次，即测得 $ m $ 组数：
\begin{center}
    \begin{tabular}{ccccc}
        $ y $      & $ x_1 $    & $ x_2 $    & $ \cdots $ & $ x_n $    \\
        \hline
        $ b_1 $    & $ a_{11} $ & $ a_{12} $ & $ \cdots $ & $ a_{1n}$  \\
        $ \vdots $ & $ \vdots $ & $ \vdots $ & $ \ddots $ & $ \vdots $ \\
        $ b_m $    & $ a_{m1} $ & $ a_{m2} $ & $ \cdots $ & $ a_{mn}$
    \end{tabular}
\end{center}
如果观测是绝对精准的，那么只需要测量 $ m = n $ 次，通过线性方程组即可解得 $ k_1, \ldots , k_n $. 但是任何观测都会有误差，这样就会需要更多的观测次数，即 $ m > n $，得到如下的线性方程组
\[ \begin{cases} \begin{aligned}
            a_{11}k_1 + \cdots + a_{1n}k_n & = b_1,          \\
            a_{21}k_1 + \cdots + a_{2n}k_n & = b_2,          \\
                                           & \vdotswithin{=} \\
            a_{m1}k_1 + \cdots + a_{mn}k_n & = b_m.          \\
        \end{aligned} \end{cases} \]
中，方程个数 $ m $ 大于未知数个数 $ n $，该线性方程组可能无解. 于是我们的目标转为寻找一组数 $ c_1, \ldots , c_n $，使得
\begin{align*}
                    & \sum_{ i = 1 }^{m} (a_{i1}c_1 + \cdots + a_{in}c_n - b_i )^{2}                                                    \\
    \leqslant \quad & \sum_{ i = 1 }^{m} (a_{i1}k_1 + \cdots + a_{in}k_n - b_i )^{2}, \enspace \forall k_1, \ldots , k_n \in \mathbf{R}
\end{align*}
此时我们把 $ (c_1, \ldots , c_n)^{\mathrm{T}} $ 称为该线性方程组的最小二乘解.

鉴于上式两侧平方和的形式类似于欧几里得空间 $ \mathbf{R}^{m} $ 下范数的平方，该问题可被转化为一个极小化问题. 该向量的第 $ i $ 个分量为
\[a_{i1}c_1 + \cdots  + a_{in}c_n - b_i, \enspace i = 1, \ldots , m\]
将线性方程组的系数矩阵记为 $ \mathbf{A} $，其列向量组记为 $ \vec{\alpha} _1 , \ldots , \vec{\alpha} _n $，行向量组记为 $ \vec{\gamma} _1 , \ldots , \vec{\gamma} _m $. 令
\[ \vec{x} = (k_1, \ldots , k_n)^{\mathrm{T}}, \enspace \vec{\beta} = (b_1, \ldots , b_n)^{\mathrm{T}}, \enspace \vec{\alpha} = (c_1, \ldots , c_n)^{\mathrm{T}}\]
将分量形式合写为
\[ \begin{pmatrix}
        \vec{\gamma} _1\vec{\alpha} - b_1 \\
        \vec{\gamma} _2\vec{\alpha} - b_2 \\
        \vdots                            \\
        \vec{\gamma} _m\vec{\alpha} - b_m \\
    \end{pmatrix}
    =
    \begin{pmatrix}
        \vec{\gamma} _1\vec{\alpha} \\
        \vec{\gamma} _2\vec{\alpha} \\
        \vdots                      \\
        \vec{\gamma} _m\vec{\alpha} \\
    \end{pmatrix}
    -
    \begin{pmatrix}
        b_1    \\
        b_2    \\
        \vdots \\
        b_m    \\
    \end{pmatrix}
    = \mathbf{A}\vec{\alpha} - \vec{\beta} \]

设 $ U = \spa(\vec{\alpha} _1 , \ldots , \vec{\alpha} _n)$，易知 $ \mathbf{A}\vec{\alpha} \in U , \enspace \mathbf{A}\vec{x} \in U , \enspace \forall k_1, \ldots , k_n \in \mathbf{R}$

从而条件转化为
\begin{align*}
               & \lVert \mathbf{A}\vec{\alpha} - \vec{\beta} \rVert^{2} \leqslant \lVert \mathbf{A}\vec{x} - \vec{\beta} \rVert^{2}, \enspace \vec{x} \in \mathbf{R}^{n} \\
    \iff \quad & P_U \vec{\beta} = \mathbf{A}\vec{\alpha}                                                                                                                \\
    \iff \quad & \vec{\beta} - \mathbf{A}\vec{\alpha} \in U^{\perp}                                                                                                      \\
    \iff \quad & \langle \vec{\beta} - \mathbf{A}\vec{\alpha}, \vec{\alpha} _j \rangle = 0, \enspace j = 1, \ldots , n                                                   \\
    \iff \quad & {\vec{\alpha} _j}^{\mathrm{T}}(\vec{\beta} - \mathbf{A}\vec{\alpha}) = 0, \enspace j = 1, \ldots , n                                                    \\
    \iff \quad & \mathbf{A}^{\mathrm{T}}(\vec{\beta} - \mathbf{A}\vec{\alpha}) = \vec{0}                                                                                 \\
    \iff \quad & \mathbf{A}^{\mathrm{T}}\mathbf{A}\vec{\alpha} = \mathbf{A}^{\mathrm{T}}\vec{\beta}
\end{align*}

由于
\begin{gather*}
    r(\mathbf{A}^{\mathrm{T}}\mathbf{A}, \mathbf{A}^{\mathrm{T}}\vec{\beta})= r (\mathbf{A}^{\mathrm{T}}(\mathbf{A}, \vec{\beta})) \leqslant r(\mathbf{A}^{\mathrm{T}}) = r(\mathbf{A}^{\mathrm{T}}\mathbf{A}) \\
    r(\mathbf{A}^{\mathrm{T}}\mathbf{A}, \mathbf{A}^{\mathrm{T}}\vec{\beta}) \geqslant r(\mathbf{A}^{\mathrm{T}}\mathbf{A})
\end{gather*}

因此$r(\mathbf{A}^{\mathrm{T}}\mathbf{A}, \mathbf{A}^{\mathrm{T}}\vec{\beta}) = r(\mathbf{A}^{\mathrm{T}}\mathbf{A})$，由我们很久之前学习的关于非齐次线性方程组有解的条件，可以得出 $ \mathbf{A}^{\mathrm{T}}\mathbf{A}\vec{x} = \mathbf{A}^{\mathrm{T}}\vec{\beta}$ 一定有解. 故求线性方程组 $\mathbf{A}\vec{x} = \vec{\beta}$ 的最小二乘解转化为求线性方程组 $ \mathbf{A}^{\mathrm{T}}\mathbf{A}\vec{x} = \mathbf{A}^{\mathrm{T}}\vec{\beta}$ 的解.

可能很多同学对于行秩、列秩相等以及转置的几何意义很感兴趣. 实际上我们有两种获得转置矩阵的方式，第一种来源于我们之前讨论的对偶空间上的线性映射对应的矩阵，这种方式可能不够直观. 另一种获得的方法基于伴随算子. 接下来我们将说明这些定义的统一性，深刻理解转置的内涵.

我们可以研究矩阵及其转置的关系，我们可以用一个图形来表示：

\begin{figure}[H]
    \centering
    \small
    \begin{tikzpicture}
        \tikzset{->-/.style={decoration={
                markings,
                mark=at position .6 with {\arrow{stealth}}},postaction={decorate}}}

        \draw[thick,rotate=45] (0, 6) rectangle (-3, 3) rectangle (-5, 0)
        (-3, 3) rectangle(-3.35, 3.35)
        coordinate (xr) at (-2, 4)
        coordinate (xn) at (-4, 2)
        coordinate (x) at (-2, 2)
        coordinate (0n) at (-3, 3)
        node at (-1, 5) {行空间}
        node at (-4, 1) {$A$的核空间}
        node at (-1.5, 6.5) {$\dim r$}
        node at (-4, 4) {$\mathbf{R}^n$}
        node at (-6, 3) {$\dim n-r$};

        \draw[thick,rotate=30] (6, 2) rectangle (3.5, -2) rectangle (0, -4)
        (3.5, -2) rectangle (3.85, -2.35)
        coordinate (b) at (4.5, 0.5)
        coordinate (0m) at (3.5, -2)
        node at (5, 1.5) {列空间}
        node at (2, -3) {$A^{\mathrm{T}}$的核空间}
        node at (7, 0) {$\dim r$}
        node at (5, -3) {$\mathbf{R}^m$}
        node at (4, -4.5) {$\dim m-r$};

        \foreach \point in {xr, x, xn, 0n, b, 0m}
        \fill[black] (\point) circle (1pt);

        \node[left] at (xr) {$x_r$};
        \node[below right] at (x) {$x=x_r+x_n$};
        \node[left] at (xn) {$x_n$};
        \node[right] at (0n) {0};
        \node[right] at (b) {$b$};

        \draw[->-,very thick] (xr) -- node[above,sloped] {$Ax_r = b$} (b);
        \draw[->-,very thick] (x) -- node[below,sloped] {$Ax = b$} (b);
        \draw[->-,very thick] (xn) -- node[below,sloped] {$Ax_n = 0$} (0m);

        \draw[dashed,thick] (xr) -- (x) -- (xn);
    \end{tikzpicture}
\end{figure}

我们观察到以下几点：
\begin{enumerate}
    \item 矩阵的行空间与解空间（零空间）互为正交补（直观理解两个空间就是互相垂直且互为补空间），这一点应当是在正交的内容中有所提及的；

    \item 矩阵的列空间与其转置矩阵的零空间互为正交补，这一点实际与上一条等价.
\end{enumerate}

接下来我们来看行秩（列秩比较显然，此处不再详细展开）. 我们首先得到解空间$N(A)$的维数，这可以直接根据维数公式得到：$\dim N(A) = n-r(A)$，根据正交补的性质，我们的可以得到行秩即为$n-(n-r(A))=r(A)$. 于是我们得到了一个基于正交补的行秩解释.

\begin{summary}

    本章是内积空间的基础，首先通过点积引入内积这一最基本的概念，然后相应地定义了范数. 然后沿着正交的路径拾级而上，从正交的定义、性质，到标准正交的向量组，标准正交基，最后到了正交的子空间：正交补. 此外，在标准正交基部分中我们顺着前人的思路，成功掌握了求标准正交基的方法，即 Gram-Schmidt 过程，也通过 Riesz 表示定理寻找到了内积的凭依：它就是我们曾学习过的线性泛函，只不过换了一种形式. 另外还有一些可能并非应试重点考察但我希望你了解一下的内容，它们往往与之后的章节或是其他的课程有着一些现阶段不容易想见的联系，如极小化的应用等. 但这正是数学的美妙之处，不是吗？

\end{summary}

\begin{exercise}
    \exquote[J. 狄奥多尼（Jean Dieudonné）]{就我个人而言，我相信如果我不曾面临那些尝试描绘并解决那些曾经全然无知的问题的经历，我或许甚至不曾完成我现在所作的工作的四分之一，甚至十分之一。}

    \begin{exgroup}
        \item 证明：下列 $\langle A, B \rangle$ 分别定义了 $n$ 阶实矩阵空间和 $n$ 阶复矩阵空间上的内积（称为 Frobenius 内积）：
        \begin{enumerate}
            \item 设 $V$ 为 $n$ 阶实矩阵空间，对任意的 $n$ 阶实矩阵 $A = (a_{ij})$ 和 $B = (b_{ij})$，定义
                  \[
                      \langle A, B \rangle = \tr(A B^{\mathrm{T}}) \sum_{i = 1}^{n} \sum_{j = 1}^{n} a_{ij}b_{ij}.
                  \]
            \item 设 $V$ 为 $n$ 阶复矩阵空间，对任意的 $n$ 阶复矩阵 $A = (a_{ij})$ 和 $B = (b_{ij})$，定义
                  \[
                      \langle A, B \rangle = \tr(A B^{\mathrm{H}}) = \sum_{i = 1}^{n} \sum_{j = 1}^{n} a_{ij}\overline{b_{ij}}.
                  \]
                  （其中 $B^{\mathrm{H}}$ 表示 $B$ 的共轭转置）
        \end{enumerate}
        \item 设 $V$ 是实系数多项式全体构成的实线性空间，任取
        \[ f(x) = a_0 + a_1 x + \cdots + a_n x^n, \enspace g(x) = b_0 + b_1 x + \cdots + b_m x^m, (a_n, b_m \neq 0), \]
        证明：如下的二元运算是 $V$ 上的内积：
        \[ \langle f, g \rangle = \sum_{i, j} \dfrac{a_i b_j}{i + j + 1}. \]
    \end{exgroup}

    \begin{exgroup}
        \item 设 $ (e_1, \ldots , e_m) $ 是复内积空间 $ V $ 的一个标准正交组，证明：$ \forall v \in V $，均有
        \[ \sum_{j = 1}^{m} \lvert \langle v, e_j \rangle \rvert^2 \leqslant \lVert v \rVert^2, \]
        等号成立当且仅当 $ v = \displaystyle\sum_{j = 1}^{m} \langle v, e_j \rangle e_j $. 这个不等式被称为 Bessel 不等式.\index{Bessel@Bessel 不等式 (Bessel's inequality)}
        \item 设 $e_1, \ldots, e_n$ 是 $V$ 的一个标准正交基. 证明：
        \begin{enumerate}
            \item 若 $v_1, \ldots, v_n \in V$ 满足
                  \[
                      \lVert e_k - v_k \rVert < \dfrac{1}{\sqrt{n}}, \quad k = 1, 2, \ldots, n,
                  \]
                  那么 $v_1, \ldots, v_n$ 是 $V$ 的一组基.
            \item 存在 $v_1, \ldots, v_n \in V$ 满足
                  \[
                      \lVert e_k - v_k \rVert \leqslant \dfrac{1}{\sqrt{n}}, \quad k = 1, 2, \ldots, n,
                  \]
                  但 $v_1, \ldots, v_n$ 线性相关.
        \end{enumerate}
    \end{exgroup}

    \begin{exgroup}
        \item 令 $V$ 是区间 $[-1, 1]$ 上次数不超过 $n$ 的实系数多项式构成的实线性空间，$V$ 上的内积定义为
        \[
            \langle f, g \rangle = \int_{-1}^{1} f(t)g(t)\,\mathrm{d}t.
        \]
        证明：$V$ 是 $n + 1$ 维欧式空间，并且下列多项式组成 $V$ 的一组正交基：
        \[
            P_0(x) = 1, \enspace P_k(x) = \dfrac{1}{2^k k!} \cdot \dfrac{\mathrm{d}^k}{\mathrm{d}x^k} (x^2 - 1)^k, \enspace k = 1, 2, \ldots, n.
        \]
        称之为 Legendre 多项式.
        \item 对于欧式空间 $V$ 向量组 $u_1, u_2, \ldots, u_m$，也同样存在着 Gram 矩阵的概念。称下述矩阵：
        \[
            G(u_1, u_2, \ldots, u_m) = \begin{pmatrix}
                \langle u_1, u_1 \rangle & \langle u_1, u_2 \rangle & \cdots & \langle u_1, u_m \rangle \\
                \langle u_2, u_1 \rangle & \langle u_2, u_2 \rangle & \cdots & \langle u_2, u_m \rangle \\
                \vdots                   & \vdots                   & \ddots & \vdots                   \\
                \langle u_m, u_1 \rangle & \langle u_m, u_2 \rangle & \cdots & \langle u_m, u_m \rangle
            \end{pmatrix}
        \]
        为向量组 $u_1, u_2, \ldots, u_m$ 的 Gram 矩阵. 证明：
        \begin{enumerate}
            \item 若用 Gram-Schmidt 过程将 $ V $ 的一个线性无关向量组 $\{u_1, u_2, \ldots, u_m\}$ 变为正交向量组 $\{v_1, v_2, \ldots, v_n\}$，则这两组向量组的 Gram 矩阵的行列式不变，即
                  \[
                      \det G(u_1, u_2, \ldots, u_m) = \det G(v_1, v_2, \ldots, v_n) = \lvert v_1 \rvert^2 \lvert v_2 \rvert^2 \cdots \lvert v_n \rvert^2.
                  \]
            \item 向量组 $u_1, u_2, \ldots, u_m$ 线性无关的充要条件是其 Gram 矩阵可逆.
            \item 不等式：
                  \[
                      0 \leqslant \det G(u_1, u_2, \ldots, u_m) \leqslant \lvert u_1 \rvert^2 \lvert u_2 \rvert^2 \cdots \lvert u_m \rvert^2.
                  \]
                  后一个等号成立的条件式 $u_i$ 两两正交或某个 $u_i$ 为 0.
            \item Hadamard 不等式：$A = (a_{ij})$ 为 $n$ 阶实矩阵，则
                  \[
                      \lvert \det A \rvert^2 \leqslant \prod_{j = 1}^n \sum_{i = 1}^n a_{ij}^2.
                  \]
        \end{enumerate}
        \item 设 $f: [-\pi, \pi] \to \mathbf{R}$ 是连续函数. 对于每个非负的整数 $k$，定义
        \[
            a_k = \dfrac{1}{\sqrt{\pi}} \int_{-\pi}^{\pi} f(x) \cos kx \mathrm{d}x, \quad b_k = \dfrac{1}{\sqrt{\pi}} \int_{-\pi}^{\pi} f(x) \sin kx \mathrm{d}x.
        \]
        证明：\[
            \dfrac{a_0^2}{2} + \sum_{k = 1}^{\infty} (a_k^2 + b_k^2) \leqslant \dfrac{1}{\pi} \int_{-\pi}^{\pi} f^2(x) \mathrm{d}x.
        \]
    \end{exgroup}
\end{exercise}
