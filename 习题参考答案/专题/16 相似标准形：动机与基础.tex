\phantomsection
\section*{16 相似标准形：动机与基础}
\addcontentsline{toc}{section}{16 相似标准形：动机与基础}

\vspace{2ex}

\centerline{\heiti A组}
\begin{enumerate}
    \item 非常简单，可以举$\begin{pmatrix}
                  1 & 0 \\ 0 & 1
              \end{pmatrix}$和$\begin{pmatrix}
                  1 & 0 \\ 0 & 2
              \end{pmatrix}$的例子，也可以举一个可对角化另一个不可对角化的例子，因为上述情况矩阵对应的相似标准形不一样，故不相似.

    \item 解$|\lambda E-A|=0$可得特征值为$1,1,-2$. 然后解$(E-A)X=0$得$X=t_1(-1,1,0)^\mathrm{T}+t_2(1,0,1)^\mathrm{T}$；解$(-2E-A)X=0$，得$X=t(-1,-1,1)^\mathrm{T}$. 可见特征值1对应的特征子空间为$\spa((-1,1,0)^\mathrm{T},(1,0,1)^\mathrm{T})$，特征值$-2$对应的特征子空间为 $\spa((-1,-1,1)^\mathrm{T})$. 可知与$A$相似的对角矩阵为 $\diag(1,1,-2)$.

    \item \begin{enumerate}
              \item $f(\lambda)=|\lambda E-A|=\begin{vmatrix}
                            \lambda-a & -b \\ -c & \lambda-d
                        \end{vmatrix}=\lambda^2-(a+d)\lambda+(ad-bc)=\lambda^2-(a+d)\lambda+|A|$. 由于$|A|<0$，因此判别式$\Delta=(a+d)^2-4|A|>0$，因此二阶矩阵$A$有两个互异特征值，故可对角化，因此与对角矩阵相似；

              \item 同 (1)，判别式$\Delta=(a+d)^2-4|A|>0$，因此二阶矩阵$A$有两个不同的特征值，故可对角化.
          \end{enumerate}

    \item \begin{enumerate}
              \item 由Cramer法则，$A$为方阵且$AX=\beta$有解但不唯一，即$|A|\neq 0$，解得$a=-2$或$a=1$，分别代入可知$a=1$时增广矩阵的秩为2，而$r(A)=1$，故无解；$a=-2$时增广矩阵的秩为2，而$r(A)=2$，故有解，故$a=-2$.

              \item 容易求得特征值为$0,-3,3$，求特征向量可知$P=\begin{pmatrix}
                            1 & -1 & 1 \\ 1 & 0 & -2 \\ 1 & 1 & 1
                        \end{pmatrix}$.
          \end{enumerate}

    \item 由分块矩阵乘法，$A(\alpha_1,\alpha_2,\alpha_3)=(A\alpha_1,A\alpha_2,A\alpha_3)=(\alpha_1,\alpha_1+\alpha_2-2\alpha_3,\alpha_1-2\alpha_2+\alpha_3)=(\alpha_1,\alpha_2,\alpha_3)\begin{pmatrix}
                  1 & 1 & 1 \\ 0 & 1 & -2 \\ 0 & -2 & 1
              \end{pmatrix}$. 令$P=(\alpha_1,\alpha_2,\alpha_3)$，则$AP=P\begin{pmatrix}
                  1 & 1 & 1 \\ 0 & 1 & -2 \\ 0 & -2 & 1
              \end{pmatrix}=PB$，即$P^{-1}AP=B$，故$A$与$B$相似，故两矩阵的特征值相同，简单求解$B$的特征值即得$A$的特征值为$1,-1,3$.

    \item 每行元素之和为3，则我们知道$\alpha=(1,1,1)^\mathrm{T}$是3对应的特征向量（具体理由只需要验证$A\alpha=3\alpha$即可，这是很常用的性质），而$AX=0$的解是对应特征值0的特征向量，故由题意可知取$P=\begin{pmatrix}
                  1 & -1 & 0 \\ 1 & 2 & -1 \\ 1 & -1 & 1
              \end{pmatrix}$，则$P^{-1}AP=\begin{pmatrix}
                  3 & 0 & 0 \\ 0 & 0 & 0 \\ 0 & 0 & 0
              \end{pmatrix}$.
\end{enumerate}

\centerline{\heiti B组}
\begin{enumerate}
    \item 回忆例题中$A^2=2A$，即$A(A-2E)=O$的证明，我们知道$A$的特征值只能为$a$或$b$，然后我们可以证明$r(aE-A)+r(bE-A)\leqslant n$和$r(aE-A)+r(bE-A)\geqslant n$，因此$r(aE-A)+r(bE-A)=n$，即$A$可对角化（由于和例题完全类似，这里不再展开具体做法）.

    \item 根据例题中关于$A^2=A$的讨论可知，满足$A^2=A$的矩阵$A$可对角化（设过渡矩阵为$P$），特征值0和1的重数分别为$n-r$和$r$，因此$|A-2E|=|P^{-1}||A-2E||P|=|\diag(-1,\ldots,-1,-2,\ldots,-2)|=(-1)^r(-2)^{n-r}$.

    \item 三阶矩阵如果有三个特征值则一定可对角化，故由题意$T$只能有6和7两个特征值. 故$\lambda\neq 6,7$时$T-\lambda I$都是可逆的（回顾正文中的定理），故$T-8I$可逆（故是满射），因此一定存在$(x,y,z)\in\mathbf{C}^3$使得$(T-8I)(x,y,z)=(17,\sqrt{5},2\pi)$，因此存在$(x,y,z)\in\mathbf{C}^3$使得$T(x,y,z)=(17+8x,\sqrt{5}+8y,2\pi+8z)$.

    \item 可对角化矩阵特征值（包括重数）相等则相似标准形（对角矩阵）相等，故一定相似. 不可对角化的举例说明不成立：$\begin{pmatrix}
                  0 & 1 & 0 \\ 0 & 0 & 1 \\ 0 & 0 & 0
              \end{pmatrix}$和$\begin{pmatrix}
                  0 & 1 & 0 \\ 0 & 0 & 0 \\ 0 & 0 & 0
              \end{pmatrix}$的特征值全为0（重数均为3），但它们对应不同的若当标准形（之后章节会介绍），因此不相似.

    \item 直接计算$|\lambda E-A|=0$，得到$A$的特征值为$-2,6,6$，因为$A$可对角化，则特征值6对应的特征子空间为2维，即$(6E-A)X=0$的解空间为2维，根据齐次线性方程组一般理论，$r(6E-A)=3-2=1$，即$r\begin{pmatrix}
                  4 & -2 & 0 \\ -8 & 4 & -a \\ 0 & 0 & 0
              \end{pmatrix}=1$，显然$a=0$. 接下来求解-2和6对应的特征向量即可，得到可行的解$P=\begin{pmatrix}
                  -1 & 1 & 0 \\ 2 & 2 & 0 \\ 0 & 0 & 1
              \end{pmatrix}$.

    \item \begin{enumerate}
              \item 上三角矩阵特征值就是所有主对角元$a_{ii},\enspace i=1,2,\ldots,n$；

              \item 由（1）知主对角元互不相等表示$A$有$n$个互不相等的特征值，故可对角化；

              \item 由（1）知此时$A$有一个$n$重特征值，记为$c$，则所有特征向量都在$(cE-A)X=0$的解空间中，而$r(cE-A)=1$，故解空间维数为$n-1<n$，故$A$不可对角化.
          \end{enumerate}

    \item \begin{enumerate}
              \item $A=\begin{pmatrix}
                            2 & -2 & 0 \\ -2 & 1 & -2 \\ 0 & -2 & 0
                        \end{pmatrix}$；

              \item $B=\begin{pmatrix}
                            0 & -2 & 0 \\ -3 & 1 & -2 \\ 1 & -1 & 2
                        \end{pmatrix}$；

              \item 根据讲义本讲开头的定理（线性变换在不同基下的表示），$C_1$实际上就是基$\alpha_1,\alpha_2,\alpha_3$变为自然基$e_1,e_2,e_3$的过渡矩阵，简单计算可得$\begin{pmatrix}
                            1 & 0 & 0 \\ -1 & 1 & 0 \\ 0 & -1 & 1
                        \end{pmatrix}$.
          \end{enumerate}

    \item 不难解得$A$和$B$的特征值均为$-1,0,1$，因此它们都与$\begin{pmatrix}
                  -1 & 0 & 0 \\ 0 & 0 & 0 \\ 0 & 0 & 1
              \end{pmatrix}$相似，即$A$与$B$相似. 我们也可以解得$P_1=\begin{pmatrix}
                  -1 & 0 & 1 \\ 0 & 1 & 0 \\ 1 & 0 & 1
              \end{pmatrix}$和$P_2=\begin{pmatrix}
                  0 & 0 & 1 \\ -1 & -2 & 0 \\ 1 & 1 & 0
              \end{pmatrix}$使得$P_1^{-1}AP_1=P_2^{-1}BP_2=\begin{pmatrix}
                  -1 & 0 & 0 \\ 0 & 0 & 0 \\ 0 & 0 & 1
              \end{pmatrix}$，故$(P_1P_2^{-1})^{-1}A(P_1P_2^{-1})=B$，即题目要求的$P=P_1P_2^{-1}=\begin{pmatrix}
                  1 & -1 & -2 \\ 0 & -1 & -1 \\ 1 & 1 & 2
              \end{pmatrix}$.

    \item \begin{enumerate}
              \item $A$与$B$相似则特征值相等，我们知道矩阵的对角线元素之和等于特征值之和，行列式等于特征值之积，则它们也一定相等. 根据这一原理非常容易解得$x=0,y=1$.

              \item 事实上$B$就是对角矩阵，实际上这里就是求过渡矩阵$P$使$A$对角化，具体步骤不再赘述，得到$P=\begin{pmatrix}
                            1 & 0 & 0 \\ 0 & 1 & 1 \\ 0 & 1 & -1
                        \end{pmatrix}$.
          \end{enumerate}

    \item 令$A_1=\begin{pmatrix}
                  1 & 2 \\ 4 & 3
              \end{pmatrix}$，$A_2=\begin{pmatrix}
                  1 & -3 & 3 \\ 3 & -5 & 3 \\ 6 & -6 & 4
              \end{pmatrix}$，则$A=\begin{pmatrix}
                  A_1 & O \\ O & A_2
              \end{pmatrix}$. 首先得到$A_1$和$A_2$的特征值分别为$-1,5$和$-2,-2,4$. 分别求过渡矩阵$P_1$和$P_2$使得$A_1$，$A_2$对角化，容易解得$P_1=\begin{pmatrix}
                  -1 & 1 \\ 1 & 2
              \end{pmatrix}$，$P_2=\begin{pmatrix}
                  1 & 1 & 1 \\ 1 & 0 & 1 \\ 0 & -1 & 2
              \end{pmatrix}$. 令$P=\begin{pmatrix}
                  P_1 & O \\ O & P_2
              \end{pmatrix}$，则
          \[P^{-1}AP=\begin{pmatrix}
                  P_1^{-1}A_1P_1 & O \\ O & P_2^{-1}A_2P_2
              \end{pmatrix}=\begin{pmatrix}
                  -1 & 0 & 0 & 0 & 0 \\ 0 & 5 & 0 & 0 & 0 \\ 0 & 0 & -2 & 0 & 0 \\ 0 & 0 & 0 & -2 & 0 \\ 0 & 0 & 0 & 0 & 4
              \end{pmatrix},\]
          即$P^{-1}AP=\diag(-1,5,-2,-2,4)$，故$A$与$\diag(-1,5,-2,-2,4)$相似. 总之，$A$的特征值为$-1,5,-2,-2,4$，过渡矩阵$P=\begin{pmatrix}
                  P_1 & O \\ O & P_2
              \end{pmatrix}=\begin{pmatrix}
                  -1 & 1 & 0 & 0 & 0 \\ 1 & 2 & 0 & 0 & 0 \\ 0 & 0 & 1 & 1 & 1 \\ 0 & 0 & 1 & 0 & 1 \\ 0 & 0 & 0 & -1 & 2
              \end{pmatrix}$.

          （注：通过本题也可以看出分块对角矩阵的特征值是两个对角块矩阵的并集，过渡矩阵就是两个过渡矩阵按同样分块方式排列得到的矩阵.）

    \item 回顾对角化过程可知，令$P=(\xi_1,\xi_2,\xi_3)=\begin{pmatrix}
                  1 & 1 & 1 \\ 1 & 2 & 3 \\ 1 & 4 & 9
              \end{pmatrix}$，则$P^{-1}AP=\begin{pmatrix}
                  1 & 0 & 0 \\ 0 & 2 & 0 \\ 0 & 0 & 3
              \end{pmatrix}$，即$P^{-1}A^nP=\begin{pmatrix}
                  1 & 0 & 0 \\ 0 & 2^n & 0 \\ 0 & 0 & 3^n
              \end{pmatrix}$，故$A^n=P\begin{pmatrix}
                  1 & 0 & 0 \\ 0 & 2^n & 0 \\ 0 & 0 & 3^n
              \end{pmatrix}P^{-1}$，最后可以计算得到$A^n\beta=\begin{pmatrix}
                  2-2^{n+1}+3^n \\ 2-2^{n+2}+3^{n+1} \\ 2-2^{n+3}+3^{n+2}
              \end{pmatrix}$.

    \item 设$A=\begin{pmatrix}
                  A_1 & O \\ O & A_2
              \end{pmatrix}$，其中$A_1=\begin{pmatrix}
                  3 & 4 \\ 4 & -3
              \end{pmatrix}$，$A_2=\begin{pmatrix}
                  2 & 4 \\ 0 & 2
              \end{pmatrix}$. 回顾矩阵运算进阶中介绍的求幂方法，我们发现$A_2=2E+B$，其中$B=\begin{pmatrix}
                  0 & 4 \\ 0 & 0
              \end{pmatrix}$，且$B^2=O$，因此$A_2^n=(2E+B)^n=2^nE+n2^{n-1}B=\begin{pmatrix}
                  2^n & n2^{n+1} \\ 0 & 2^n
              \end{pmatrix}$. 再看$A_1$，我们用对角化方法求幂，容易求得$P=\begin{pmatrix}
                  2 & -1 \\ 1 & 2
              \end{pmatrix}$使得$P^{-1}A_1P=\begin{pmatrix}
                  5 & 0 \\ 0 & -5
              \end{pmatrix}$，故$A_1^n=P\begin{pmatrix}
                  5^n & 0 \\ 0 & (-5)^n
              \end{pmatrix}P^{-1}=5^{n-1}\begin{pmatrix}
                  4+(-1)^n & 2+2(-1)^{n+1} \\ 2+2(-1)^{n+1} & 1+4(-1)^n
              \end{pmatrix}$，最后结合上面的讨论得到$A^n=\begin{pmatrix}
                  A_1^n & O \\ O & A_2^n
              \end{pmatrix}$.

    \item \begin{enumerate}
              \item 由题意，$PB=AP$，利用分块矩阵乘法可知$PB=AP=(AX,A^2X,A^3X)=(AX,A^2X,3AX-2A^2X)$（注意$(AX,A^2X,A^3X)B=(AXB,A^2XB,A^3XB)$是错误的，因为这是$1\times 3$分块和$1\times 1$分块相乘，显然不能这么乘）.

                    则$PB=(AX,A^2X,3AX-2A^2X)=(X,AX,A^X)\begin{pmatrix}
                            0 & 0 & 0 \\ 1 & 0 & 3 \\ 0 & 1 & -2
                        \end{pmatrix}$. 等号两边左乘$P^{-1}$有$B=\begin{pmatrix}
                            0 & 0 & 0 \\ 1 & 0 & 3 \\ 0 & 1 & -2
                        \end{pmatrix}$.

              \item 由于$A$与$B$相似，故有相同的特征值，易求得$B$的特征值为$0,-3,1$，则$A$的特征值也为$0,-3,1$，则$A+E$的特征值根据正文例题可知为$1,-2,2$，则$A+E$的行列式为其特征值之积，即为$-4$.
          \end{enumerate}

          % \item 思路：将$B$分块为$\begin{pmatrix}
          %     B_1 & O \\ O & B_2
          % \end{pmatrix}$，其中$B_1=\begin{pmatrix}
          %     1 & 0 \\ -1 & 1
          % \end{pmatrix}$，$B_2=\begin{pmatrix}
          %     1 & -1 & -1 \\ -2 & -2 & 2 \\ -3 & -3 & 3
          % \end{pmatrix}$. 我们知道$B^n=\begin{pmatrix}
          %     B_1^n & O \\ O & B_2^n
          % \end{pmatrix}$. $B_1$可以直接用数学归纳法证明（或者这就是一个倍加行变换，幂次是非常显然的），$B_2$使用对角化方法求解幂次，较为复杂，此处省略结果，了解过程即可.
\end{enumerate}

\centerline{\heiti C组}
\begin{enumerate}
    \item 暂略，有需要可以参考\href{https://linearalgebras.com/5c.html}{《线性代数应该这样学》作者给出的答案（见网页第五题）}；

    \item \begin{enumerate}
              \item $B^2=\alpha(\alpha^\mathrm{T}\alpha)\alpha^\mathrm{T}=m\alpha\alpha^\mathrm{T}=mB$，其中$m=\alpha^\mathrm{T}\alpha=a_1^2+\cdot+a_n^2$，且易知这就是$\tr(B)$. 用归纳法可知$B^k=m^{k-1}B$，令$t=m^{k-1}$则得证，其中$t=(\tr(B))^{k-1}$.

              \item 这是经典的秩1矩阵，由于$B$的秩为1，则$BX=0$的解空间维数为$n-1$，因此0是$B$的$n-1$重特征值. 而特征值之和等于矩阵的迹. 则剩下一个一重特征值为$\tr(B)$（由题意迹不为0）.

                    然后求特征向量，这里需要一些观察. 特征值0对应的特征向量即为$BX=0$的解，设解为$(x_1,\ldots,x_n)$，不失一般性地，设$a_1\neq 0$，由于$B$的秩为1，因此将$BX=0$展开为线性方程组后，每一行（除去全0的）代表的方程是完全一致的（因为它们成比例），因此我们只需考虑第一行方程
                    \[a_1^2x_1+a_1a_2x_2+\cdots+a_1a_nx_n=0,\]
                    解得$n-1$个线性无关特征向量为
                    \[X_1=(-a_2,a_1,0,\ldots,0),X_2=(-a_3,0,a_1,0,\ldots,0),\ldots,X_{n-1}=(-a_n,0,\ldots,0,a_1).\]
                    对于特征值$\tr(B)=\alpha^\mathrm{T}\alpha$，我们可以设特征向量为$X$，则$(\tr(B)E-B)X=(\alpha^\mathrm{T}\alpha E-\alpha\alpha^\mathrm{T})X=0$，即$\alpha^\mathrm{T}X=\alpha\alpha^\mathrm{T}X$，我们可以观察发现$\alpha$就是一个解，则$X_n=\alpha$是其特征向量. 则$P=\begin{pmatrix}
                            -a_2 & -a_3 & \cdots & -a_n & a_1 \\ a_1 & 0 & \cdots & 0 & a_2 \\ 0 & a_1 & \cdots & 0 & a_3 \\ \vdots & \vdots & \ddots & \vdots & \vdots \\ 0 & 0 & \cdots & a_1 & a_n
                        \end{pmatrix}$，且对角矩阵为$\diag(0,\ldots,0,\alpha^\mathrm{T}\alpha)$.
          \end{enumerate}

    \item \begin{enumerate}
              \item 由题意知$A$的秩为1，因此特征值0对应的特征子空间为$AX=0$的解空间，维数为$n-1$，故特征值0的重数至少为$n-1$. 剩下可能还有一个特征值，我们知道特征值之和等于对角线元素之和，因此最后一个特征值等于$n$，$n$对应的特征子空间维数至少为1，结合0对应特征子空间维数为$n-1$可知$n$对应的特征子空间维数就是1，二者可以张成整个$\mathbf{R}^n$，因此可以对角化.

                    下面求过渡矩阵，$n$对应的特征向量只需解方程$(nE-A)X=0$，即得$X_1=(1,1,\ldots,1)^\mathrm{T}$. 0对应的$n-1$个线性无关特征向量就是$AX=0$的基础解系，即$X_2=(-1,1,0,\ldots,0)^\mathrm{T},X_3=(-1,0,1,0,\ldots,0)^\mathrm{T},\ldots,X_n=(-1,0,\ldots,0,1)^\mathrm{T}$，令$P=(X_1,X_2,\ldots,X_n)=\begin{pmatrix}
                            1 & -1 & -1 & \cdots & -1 \\ 1 & 1 & 0 & \cdots & 0 \\ 1 & 0 & 1 & \cdots & 0 \\ \vdots & \vdots & \vdots & \ddots & \vdots \\ 1 & 0 & 0 & \cdots & 1
                        \end{pmatrix}$，则有$P^{-1}AP=\varLambda=\diag(n,0,\ldots,0)$.

              \item 由上一小问可知$A=P\varLambda P^{-1}$，则$A^k=P\varLambda^kP^{-1}$，故
                    \[A^k=P\varLambda^kP^{-1}=P\diag(n^k,0,\ldots,0)P^{-1},\]
                    故
                    \begin{align*}
                        f(A) & =a_mA^m+a_{m-1}A^{m-1}+\cdots+a_1A                                                                                                   \\
                             & =P(a_m\varLambda^m+a_{m-1}\varLambda^{m-1}+\cdots+a_1\varLambda)P^{-1}                                                               \\
                             & =P\begin{pmatrix}
                                     a_mn^m+a_{m-1}n^{m-1}+\cdots+a_1n & 0 & \cdots & 0 \\ 0 & 0 & \cdots & 0 \\ \vdots & \vdots & \ddots & \vdots \\ 0 & 0 & \cdots & 0
                                 \end{pmatrix}P^{-1} \\
                             & =\begin{pmatrix}
                                    f(n) & 0 & \cdots & 0 \\ 0 & 0 & \cdots & 0 \\ \vdots & \vdots & \ddots & \vdots \\ 0 & 0 & \cdots & 0
                                \end{pmatrix}=\dfrac{f(n)}{n}P\begin{pmatrix}
                                                                  n & 0 & \cdots & 0 \\ 0 & 0 & \cdots & 0 \\ \vdots & \vdots & \ddots & \vdots \\ 0 & 0 & \cdots & 0
                                                              \end{pmatrix}P^{-1}    \\
                             & =\dfrac{f(n)}{n}P\varLambda P^{-1}=kA.
                    \end{align*}
                    其中$k=\dfrac{f(n)}{n}$. 故$f(A)=kA$.

              \item 显然$X=(1,1,x\cdots,1)^\mathrm{T}$是$B$关于特征值$b$的特征向量，由于$b$是特征多项式的单根，则特征子空间维数也为1，故特征向量就是$kX$（其中$k$为非零常数）.

                    又$f(B)=(B-bE)g(B)=O$，则$Bg(B)=bg(B)$. 令$g(B)$的列向量组为$\alpha_1,\ldots,\alpha_n$，则上式可以写为$B(\alpha_1,\ldots,\alpha_n)=(b\alpha_1,\ldots,b\alpha_n)$，即$B\alpha_i=b\alpha_i$，即$\alpha_i$是$B$关于特征值$b$的特征向量，故$\alpha_i=k_iX=(k_i,k_i,\ldots,k_i)^{\mathrm{T}}$，即$g(B)=\begin{pmatrix}
                            k_1 & k_2 & \cdots & k_n \\ k_1 & k_2 & \cdots & k_n \\ \vdots & \vdots & \ddots & \vdots \\ k_1 & k_2 & \cdots & k_n
                        \end{pmatrix}$. 由于$B$是实对称矩阵，故$g(B)$也是实对称矩阵（很容易验证实对称矩阵经过幂次、加法运算后仍是实对称矩阵），因此$g(B)=(g(B))^\mathrm{T}$，故$k_1=k_2=\cdots=k_n=k$，即$g(B)=kA$.
          \end{enumerate}

    \item \begin{enumerate}
              \item 设$\alpha$是$B$的特征向量，对应的特征值为$\lambda$，即$B\alpha=\lambda\alpha$，则$A\alpha+B\alpha-AB\alpha=0$，即$A\alpha+\lambda\alpha-A\lambda\alpha=0$，即$(1-\lambda)A\alpha=-\lambda\alpha$. 若$\lambda=1$，则$\alpha=0$，与它是特征向量矛盾，故$\lambda\neq 1$，从而$A\alpha=\dfrac{-\lambda}{1-\lambda}\alpha$，这就说明了$B$的特征向量就是$A$的特征向量.

                    由$A+B=AB$可知，$(A-E)(B-E)=E$，故$A-E$可逆，且$(A-E)^{-1}=B-E$，从而$E=(B-E)(A-E)=BA-A-B+E$，故$BA=A+B$，同上理可得$A$的特征向量也是$B$的，得证.

              \item \begin{enumerate}
                        \item 必要性：若$A$可对角化，则$\mathbf{R}^n$有一组由$A$的特征向量张成的基，由（1）知$B$与$A$特征向量一致，故$\mathbf{R}^n$也有一组由$B$的特征向量张成的基，即$B$可对角化.

                        \item 充分性与必要性类似.
                    \end{enumerate}

              \item 由$A+B=AB$可知$A=(A-E)B$且$B=A(B-E)$，由此可得$r(A)\leqslant r(B)\leqslant r(A)$，故$r(A)=r(B)$.
          \end{enumerate}

    \item \begin{enumerate}
              \item 必要性：$A$和$B$在实数域上相似，则存在可逆实矩阵$C$使得$B=C^{-1}AC$，将$A,B,C$视为复数域上的矩阵，则可知$A$和$B$在复数域上也相似.

              \item 充分性：若$A$和$B$在复数域上相似，则存在可逆复矩阵$P=P_1+\i P_2$使得$B=P^{-1}AP$，其中$P_1,P_2$是实矩阵，即$AP=PB$，从而$A(P_1+\i P_2)=(P_1+\i P_2)B$，比较实部虚部可知$AP_1=P_1B$且$AP_2=P_2B$. 构造实系数多项式$f(t)=|P_1+tP_2|$，显然$f(\i)=|P|\neq 0$，则$f(t)$是非零多项式，所以$f(t)$的根只有有限多个，从而存在$t_0\in\mathbf{R}$使得$f(t_0)\neq 0$，则$|P_1+t_0P_2|\neq 0$，从而$P_1+t_0P_2$可逆，从而$A(P_1+t_0P_2)=AP_1+t_0AP_2=P_1B+t_0P_2B=(P_1+t_0P_2)B$，即$(P_1+t_0P_2)^{-1}A(P_1+t_0P_2)=B$，即$A$和$B$在实数域上相似.
          \end{enumerate}

    \item \label{ex:交换对角化}
          \begin{enumerate}
              \item \begin{enumerate}
                        \item 必要性：$A$有$n$个互不相等的特征值，则$A$一定可对角化，则$A$有$n$个线性无关特征向量，记为$X_1,\ldots,X_n$，则$AX_i=\lambda_iX_i\enspace (X_i\neq 0)$，则$A(BX_i)=B(AX_i)=\lambda_i(BX_i)$，即$BX_i$属于$A$的特征子空间$V_{\lambda_i}$，又$\lambda_i$是$A$的单重特征值，对应的特征子空间是一维的，故$V_{\lambda_i}$中任两个向量成比例，即$BX_i=\mu_iX_i$，故$X_i$也是$B$关于特征值$\mu_i$的特征向量.

                        \item 充分性：必要性：$A$有$n$个互不相等的特征值，则$A$一定可对角化，则$A$有$n$个线性无关特征向量$X_1,\ldots,X_n$，由于它们也是$B$的特征向量，故$B$可对角化. 设$P=(X_1,\ldots,X_n)$，则$P^{-1}AP=\varLambda_1$，$P^{-1}BP=\varLambda_2$，其中$\varLambda_1$和$\varLambda_2$都是对角矩阵，则它们乘法可交换，即$(P^{-1}AP)(P^{-1}BP)=\varLambda_1\varLambda_2=\varLambda_2\varLambda_1=(P^{-1}BP)(P^{-1}AP)$，上式两边左乘$P$，右乘$P^{-1}$，则$AB=BA$.
                    \end{enumerate}

              \item 由于$A$可对角化，所以存在可逆矩阵$P$使得$P^{-1}AP=\diag(\lambda_1E_1,\ldots,\lambda_sE_s)$，其中$\lambda_1,\ldots,\lambda_s$是$A$的所有互异特征值，$E_1,\ldots,E_s$分别是$r_2,\ldots,r_s$阶单位矩阵，且$r_1+\cdots+r_s=n$，由$AB=BA$可知$P^{-1}APP^{-1}BP=P^{-1}BPP^{-1}AP$，根据正文矩阵运算进阶中对矩阵乘法可交换问题的讨论中准对角矩阵的结论，我们有$P^{-1}BP=\diag(B_1,\ldots,B_s)$，其中$B_i$是$r_i$阶矩阵. 由于$B$可对角化，因此$P^{-1}BP$也可对角化（因为它和$B$相似，故它们有相同的相似标准形），从而$B_1,\ldots,B_s$都可对角化，故对于任意的$B_i(i=1,2,\ldots,s)$，存在可逆矩阵$Q_i$使得$Q_i^{-1}B_iQ_i$是对角矩阵. 取$Q=\diag(Q_1,\ldots,Q_s)$，则$Q^{-1}P^{-1}BPQ=\diag(Q_1^{-1}B_1Q_1,\ldots,Q_s^{-1}B_sQ_s)$是对角矩阵，同时有
                    \[Q^{-1}P^{-1}APQ=\diag(\lambda_1E_1,\ldots,\lambda_sE_s),\]
                    则$Q^{-1}P^{-1}APQ=\diag(\lambda_1Q_1^{-1}Q_1,\ldots,\lambda_sQ_s^{-1}Q_s)=\diag(\lambda_1E_1,\ldots,\lambda_sE_s)$为对角矩阵，因此取$T=PQ$就有$T^{-1}AT$和$T^{-1}BT$都是对角矩阵.
          \end{enumerate}

    \item 此题条件与C组 \ref*{ex:交换对角化} 题相同，因此我们知道存在可逆矩阵$P$使得$P^{-1}AP$和$P^{-1}BP$都是对角矩阵（因为$A$的$n$个线性无关特征向量也是$B$的线性无关特征向量）. 设$P^{-1}AP=\diag(\lambda_1,\ldots,\lambda_n)$，$P^{-1}BP=\diag(\mu_1,\ldots,\mu_n)$，并设$f(x)=a_{n-1}x^{n-1}+\cdots+a_1x+a_0$满足$f(A)=B$，则$a_{n-1}A^{n-1}+\cdots+a_1A+a_0E=B$，从而
          \[a_{n-1}(P^{-1}AP)^{n-1}+\cdots+a_1(P^{-1}AP)+a_0E=P^{-1}BP,\]
          即
          \[\begin{cases} \begin{aligned}
                      a_{n-1}\lambda_1^{n-1}+\cdots+a_1\lambda_1+a_0 & = \mu_1           \\
                      a_{n-1}\lambda_2^{n-1}+\cdots+a_1\lambda_2+a_0 & = \mu_2           \\
                                                                     & \vdotswithin{ = } \\
                      a_{n-1}\lambda_n^{n-1}+\cdots+a_1\lambda_n+a_0 & = \mu_n
                  \end{aligned} \end{cases}\]
          由于$\lambda_1,\ldots,\lambda_n$两两不同，故上述方程组有唯一解（回忆范德蒙行列式和Cramer法则），从而$a_0,\ldots,a_{n-1}$有唯一解，得证.
\end{enumerate}

\clearpage
